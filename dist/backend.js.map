{"version":3,"sources":["webpack:///webpack/bootstrap 31a4eb5c3bac73ec8ea4","webpack:///external \"path\"","webpack:///external \"sequelize\"","webpack:///./src/server/db/index.ts","webpack:///./src/server/config.js","webpack:///external \"express\"","webpack:///./src/server/service/user.ts","webpack:///./utils/api/index.ts","webpack:///./webpack/frontend/partials/base.ts","webpack:///./webpack/models/Environment.ts","webpack:///./webpack/partials/aliases.ts","webpack:///external \"awesome-typescript-loader\"","webpack:///external \"chalk\"","webpack:///external \"webpack\"","webpack:///./src/server/exceptionMonitoring.ts","webpack:///./src/server/http/index.tsx","webpack:///./src/server/listen.ts","webpack:///./src/server/middleware.ts","webpack:///./src/server/serveFrontend.tsx","webpack:///./src/server/session.ts","webpack:///external \"body-parser\"","webpack:///external \"helmet\"","webpack:///./src/server/api/authentication.ts","webpack:///./src/server/db/config/index.ts","webpack:///./src/server/db/models/guest.ts","webpack:///./src/server/db/models/iteration.ts","webpack:///./src/server/db/models/post.ts","webpack:///./src/server/db/models/user.ts","webpack:///./src/server/http/authentication.ts","webpack:///./src/server/http/posts.ts","webpack:///./src/server/http/users.ts","webpack:///./src/server/main.tsx","webpack:///./src/server/service/post.mock.ts","webpack:///./src/server/service/post.ts","webpack:///./src/server/service/user.mock.ts","webpack:///./utils/models/index.ts","webpack:///./webpack/frontend/development.ts","webpack:///./webpack/frontend/index.ts","webpack:///./webpack/loaders/hot-typescript-loader.ts","webpack:///./webpack/loaders/awesome-typescript-loader.ts","webpack:///./src/server/db/config/index.js","webpack:///external \"continuation-local-storage\"","webpack:///external \"dotenv\"","webpack:///external \"express-session\"","webpack:///external \"fs\"","webpack:///external \"html-webpack-plugin\"","webpack:///external \"ramda\"","webpack:///external \"raven\"","webpack:///external \"webpack-combine-loaders\"","webpack:///external \"webpack-dev-middleware\"","webpack:///external \"webpack-hot-middleware\"","webpack:///external \"webpack-merge\""],"names":[],"mappings":"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","file":"backend.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// identity function for calling harmony imports with the correct context\n \t__webpack_require__.i = function(value) { return value; };\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 30);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 31a4eb5c3bac73ec8ea4","module.exports = require(\"path\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"path\"\n// module id = 0\n// module chunks = 0","module.exports = require(\"sequelize\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"sequelize\"\n// module id = 1\n// module chunks = 0","import * as cls       from 'continuation-local-storage'\nimport * as Sequelize from 'sequelize'\n\nimport UserModel, {IUserModel}           from '../db/models/user'\nimport PostModel, {IPostModel}           from '../db/models/post'\nimport IterationModel, {IIterationModel} from '../db/models/iteration'\n\nimport c from './config'\nconst database_url = require('../config.js').database_url\n\ninterface IModels {\n  User:      IUserModel,\n  Post:      IPostModel,\n  Iteration: IIterationModel,\n}\n\n\nclass Database {\n  /** Models supported by our DB. */\n  private models: IModels\n\n  /** Instance of our Sequelize connection. */\n  private sequelize: Sequelize.Sequelize\n\n  constructor() {\n    (Sequelize as any).cls = cls.createNamespace('sequelize-transaction')\n    if (database_url) {\n      this.sequelize = new Sequelize(database_url, c)\n    } else {\n      this.sequelize = new Sequelize(c.database, c.username, c.password, c)\n    }\n    this.models = {\n      User:      UserModel(this.sequelize),\n      Post:      PostModel(this.sequelize),\n      Iteration: IterationModel(this.sequelize),\n    }\n  }\n\n  getModels    = () => this.models\n  getSequelize = () => this.sequelize\n}\n\nconst database = new Database()\n\nexport const models    = database.getModels()\nexport const sequelize = database.getSequelize()\n\n\n\n// WEBPACK FOOTER //\n// ./src/server/db/index.ts","/**\n * Load environment variables from .env for local development.\n * If no .env file is to be found at\n */\nconst path  = require('path')\nconst chalk = require('chalk')\nconst env   = require('dotenv').config({ path: path.resolve('.env') })\n\nif (env.error) {\n  console.warn(chalk.yellow(`No config file was found at ${env.error.path}`))\n} else {\n  console.info(chalk.green('Environment variables loaded from .env:'))\n  console.info(chalk.grey(JSON.stringify(env, null, 2)))\n}\n\nmodule.exports = {\n  port:         process.env.PORT || 4000,\n  host:         process.env.HOST || 'localhost',\n  env:          process.env.NODE_ENV,\n  database_url: process.env.DATABASE_URL,\n  sentry_dsn:   process.env.SENTRY_DSN,\n  db: {\n    database: process.env.DB_NAME,\n    username: process.env.DB_USERNAME,\n    password: process.env.DB_PASSWORD,\n    host:     process.env.DB_HOST,\n    port:     process.env.DB_PORT,\n    dialect:  'postgres',\n    logging:  process.env.NODE_ENV !== 'test' && process.env.NODE_ENV !== 'ci' && console.log,\n    timezone: '+00:00',\n  }\n}\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/server/config.js\n// module id = 3\n// module chunks = 0","module.exports = require(\"express\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"express\"\n// module id = 4\n// module chunks = 0","import * as Sequelize from 'sequelize'\n\nimport {models} from '../db'\nimport {UserInstance} from '../db/models/user'\nimport {MockUserService} from './user.mock'\n\nconst sequelizeFailure = (reject: Function) => (error: Sequelize.ValidationError) => {\n  reject(error.errors[0]) // Return only the descriptive .errors array\n}\n\nexport class UserService extends MockUserService {\n  findByUsername(username: string) {\n    return new Promise<UserInstance>((resolve: Function, reject: Function) => {\n      return models.User\n        .findOne({where: {username}})\n        .then((user: UserInstance) => resolve(user))\n        .catch(sequelizeFailure(reject))\n    })\n  }\n\n  create(attributes: {username: string}) {\n    return new Promise<UserInstance>((resolve: Function, reject: Function) => {\n      return models.User\n        .create(attributes)\n        .then((user: UserInstance) => resolve(user))\n        .catch(sequelizeFailure(reject))\n    })\n  }\n\n  all() {\n    return new Promise<Array<UserInstance>>((resolve: Function, reject: Function) => {\n      return models.User\n        .findAll()\n        .then((users: Array<UserInstance>) => resolve(users))\n        .catch(sequelizeFailure(reject))\n    })\n  }\n}\n\nexport const userService = new UserService\n\n\n\n// WEBPACK FOOTER //\n// ./src/server/service/user.ts","import * as express from 'express'\n\ninterface IError {\n  message: string\n}\n\nexport const jsonError = (res: express.Response) => (error: IError) => {\n  res.status(500).json(error)\n}\n\nexport const jsonSuccess = (res: express.Response) => (json: any) => {\n  res.status(200).json(json)\n}\n\n\n\n// WEBPACK FOOTER //\n// ./utils/api/index.ts","import * as path    from 'path'\nimport * as webpack from 'webpack'\n\nconst HtmlWebpackPlugin = require('html-webpack-plugin')\n\nimport * as Options from 'webpack/models/Options'\n\nconst entryFile = './src/frontend/main.tsx'\nexport const partial = (c: Options.Interface): webpack.Configuration => ({\n  entry: c.isProd ? entryFile : {app: ['webpack-hot-middleware/client?reload=true', entryFile]},\n\n  output: {\n    path:       path.join(c.rootDir, c.outputDir),\n    filename:   'frontend.js',\n    publicPath: '/', // Prepended to urls injected by HtmlWebpackPlugin\n  },\n\n  devtool: c.devtool,\n\n  plugins: [\n    ...(c.isProd ? [] : [new webpack.HotModuleReplacementPlugin()]),\n    new HtmlWebpackPlugin({ template: './src/frontend/index.html' }),\n  ]\n})\n\n\n\n\n// WEBPACK FOOTER //\n// ./webpack/frontend/partials/base.ts","import * as U from '../../utils/models'\n\nexport const Enum = U.strEnum([\n  'development',\n  'production',\n])\n\nexport type Type = keyof typeof Enum\n\n\n\n// WEBPACK FOOTER //\n// ./webpack/models/Environment.ts","import * as path    from 'path'\nimport * as webpack from 'webpack'\n\nimport * as Options from 'webpack/models/Options'\n\nexport const partial = (c: Options.Interface): webpack.Configuration => ({\n  resolve: {\n    modules: ['node_modules', path.join(c.rootDir, 'src')],\n\n    /**\n     * Though the project's source is in Typescript, we must support Javascript\n     * resolution as well, because some node_modules import JS files.\n     */\n    extensions: ['.tsx', '.ts', '.js', '.jsx', '.json'],\n\n    alias: {\n      '~': path.resolve('./src'),\n    },\n  },\n})\n\n\n\n\n\n// WEBPACK FOOTER //\n// ./webpack/partials/aliases.ts","module.exports = require(\"awesome-typescript-loader\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"awesome-typescript-loader\"\n// module id = 10\n// module chunks = 0","module.exports = require(\"chalk\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"chalk\"\n// module id = 11\n// module chunks = 0","module.exports = require(\"webpack\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"webpack\"\n// module id = 12\n// module chunks = 0","/**\n * Further details on Sentry setup for Express/Node:\n *   - docs.sentry.io/clients/node/integrations/express/\n *   - docs.sentry.io/clients/node/config/\n */\n\nimport * as express from 'express'\nconst Raven = require('raven')\n\ninterface ISentryConfig {\n  sentry_dsn: string\n  env: string\n}\n\nexport const monitorExceptions = (config: ISentryConfig) => (app: express.Application) => {\n  // Must configure Raven before doing anything else with it\n  Raven.config(config.sentry_dsn, { environment: config.env }).install()\n\n  // The request handler must be the first middleware on the app\n  app.use(Raven.requestHandler())\n\n  // The error handler must be before any other error middleware\n  app.use(Raven.errorHandler())\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/server/exceptionMonitoring.ts","import * as express from 'express'\n\nimport UsersAPI from './users'\nimport PostsRouter from './posts'\nimport AuthenticationAPI from './authentication'\n\nexport default (app: express.Application) => {\n  UsersAPI(app)\n  app.use('/api/posts', PostsRouter)\n  AuthenticationAPI(app)\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/server/http/index.tsx","import * as express from 'express'\nimport * as Chalk   from 'chalk'\n\nexport const listen = (app: express.Application, { host, port }: { host: string, port: number }) => {\n  console.info(Chalk.black.bgGreen(`\\n\\nListening at http://${host}:${port}\\n`))\n  app.listen(port)\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/server/listen.ts","import * as express from 'express'\n\nexport const runHotMiddleware = (app: express.Application) => {\n  const webpack         = require('webpack')\n  const webpackConfig   = require('../../webpack/frontend/development').default\n  const webpackCompiler = webpack({\n    ...webpackConfig,\n    entry: './src/frontend/main.tsx',\n  })\n\n  app.use(require('webpack-dev-middleware')(webpackCompiler, {\n    publicPath:         webpackConfig.output.publicPath,\n    stats:              { colors: true },\n    noInfo:             true,\n    hot:                true,\n    inline:             true,\n    lazy:               false,\n    historyApiFallback: true,\n    quiet:              true,\n  }))\n\n  app.use(require('webpack-hot-middleware')(webpackCompiler))\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/server/middleware.ts","import * as express from 'express'\n\ndeclare var __OUTPUT_DIR__: boolean // Defined by webpack.DefinePlugin at compile time\n\nexport const serveFrontend = (app: express.Application) => {\n  const fs   = require('fs')\n  const path = require('path')\n\n  app.use('/', express.static(__dirname))\n\n  app.get('*', (_: express.Request, res: express.Response) => {\n    const file = path.join(__OUTPUT_DIR__, 'index.html') // TODO: Replace with raw-loader require\n    const html = fs.readFileSync(file).toString()\n    res.status(200).send(html)\n  })\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/server/serveFrontend.tsx","import * as express from 'express'\nimport * as session from 'express-session'\n\nexport const setupSession = (app: express.Application) => {\n  /** More info: github.com/expressjs/session#options */\n  const options: session.SessionOptions = {\n    secret: 'ssshhhhh', // TODO: get secret from env\n    resave: false,\n    saveUninitialized: true,\n  }\n\n  app.use(session(options))\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/server/session.ts","module.exports = require(\"body-parser\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"body-parser\"\n// module id = 19\n// module chunks = 0","module.exports = require(\"helmet\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"helmet\"\n// module id = 20\n// module chunks = 0","import * as R from 'ramda'\nimport {UserInstance}  from '../db/models/user'\nimport {GuestInstance} from '../db/models/guest'\nimport {userService}   from '../service/user'\n\nexport const signup = (username: string|undefined, session: Express.Session|undefined) => (\n  new Promise<UserInstance>((resolve: Function, reject: Function) => {\n    if (!username) {\n      return reject({message: 'You must provide a username'})\n    }\n    if (!session) {\n      return reject({message: 'You must initialize the API with a session'})\n    }\n    userService.create({username}).then((user: UserInstance) => {\n      session['username'] = username\n      return resolve(user)\n    }).catch((e: {message: string, type: string, value: string}) => {\n      if (e.type === 'unique violation') {\n        return reject({message: `The username \"${e.value}\" is not available`})\n      }\n      return reject(R.pick(['message'], e))\n    })\n  })\n)\n\nexport const signIn = (username: string|undefined, session: Express.Session|undefined) => (\n  new Promise<UserInstance>((resolve: Function, reject: Function) => {\n    if (!username) {\n      return reject({message: 'You must provide a username'})\n    }\n    if (!session) {\n      return reject({message: 'You must initialize the API with a session'})\n    }\n    userService.findByUsername(username).then((user: UserInstance) => {\n      if (!user) {\n        return reject({message: `User with username \"${username}\" does not exist`})\n      }\n      session['username'] = username\n      return resolve(user)\n    }).catch(e => reject(e))\n  })\n)\n\nexport const signout = (session: Express.Session|undefined) => (\n  new Promise<UserInstance>((resolve: Function, reject: Function) => {\n    if (!session) {\n      return reject({message: 'You must initialize the API with a session'})\n    }\n    session['username'] = undefined\n    return resolve()\n  })\n)\n\nexport const getCurrentUser = (session: Express.Session|undefined) => (\n  new Promise<UserInstance>((resolve: Function, reject: Function) => {\n    if (!session) {\n      return reject({message: 'You must initialize the API with a session'})\n    }\n\n    if (!session.username) {\n      return resolve(new GuestInstance)\n    }\n\n    userService\n      .findByUsername(session.username)\n      .then((user: UserInstance) => resolve(user))\n      .catch(e => reject(e))\n  })\n)\n\n\n\n// WEBPACK FOOTER //\n// ./src/server/api/authentication.ts","import {IDatabaseConfig} from './interface'\n\nconst config: IDatabaseConfig = require('./index.js')\n\nexport default config\n\n\n\n// WEBPACK FOOTER //\n// ./src/server/db/config/index.ts","import {IPerson} from './person'\n\nexport class GuestInstance implements IPerson {\n  username = null\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/server/db/models/guest.ts","import * as SequelizeStatic from 'sequelize'\nimport {Instance, Sequelize} from 'sequelize'\nimport {IPostModel} from './post'\n\nexport interface IterationAttributes {\n  postId: number\n  body?:  string\n  title:  string\n}\n\nexport interface IterationSchema extends IterationAttributes {\n  createdAt: string\n}\n\nexport interface IterationInstance extends Instance<IterationAttributes> {\n  dataValues: IterationAttributes\n}\n\nexport type IIterationModel = SequelizeStatic.Model<IterationInstance, IterationAttributes>\n\nexport default (sequelize: Sequelize): IIterationModel => {\n  const Schema = {\n    id: {\n      allowNull:     false,\n      autoIncrement: true,\n      primaryKey:    true,\n      type:          SequelizeStatic.INTEGER,\n    },\n    createdAt: {\n      allowNull: false,\n      type:      SequelizeStatic.DATE,\n    },\n    postId: {\n      type:      SequelizeStatic.INTEGER,\n      allowNull: false,\n    },\n    body: {\n      type: SequelizeStatic.TEXT,\n    },\n    title: {\n      type:      SequelizeStatic.STRING,\n      allowNull: false,\n    },\n  }\n  const Iteration = sequelize.define<IterationInstance, IterationAttributes>('Iteration', Schema, {\n    classMethods: {\n      associate: (models: {Post: IPostModel}) => Iteration.belongsTo(models.Post),\n    },\n  })\n  return Iteration\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/server/db/models/iteration.ts","import * as SequelizeStatic from 'sequelize'\nimport {Instance, Sequelize} from 'sequelize'\nimport {IUserModel} from './user'\n\nexport interface PostAttributes {\n  userId:     number\n  createdAt?: Date\n  // NOTE: updatedAt is not part of the Post interface\n}\n\nexport interface PostSchema extends PostAttributes {\n  id: number\n}\n\nexport interface PostInstance extends Instance<PostAttributes> {\n  dataValues: PostAttributes\n}\n\nexport type IPostModel = SequelizeStatic.Model<PostInstance, PostAttributes>\n\nexport default (sequelize: Sequelize): IPostModel => {\n  const Schema = {\n    id: {\n      allowNull:     false,\n      autoIncrement: true,\n      primaryKey:    true,\n      type:          SequelizeStatic.INTEGER,\n    },\n    createdAt: {\n      allowNull: false,\n      type:      SequelizeStatic.DATE,\n    },\n    userId: {\n      type:      SequelizeStatic.INTEGER,\n      allowNull: false,\n    },\n  }\n  const Post = sequelize.define<PostInstance, PostAttributes>('Post', Schema, {\n    classMethods: {\n      associate: (models: {User: IUserModel}) => Post.belongsTo(models.User),\n    },\n  })\n  return Post\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/server/db/models/post.ts","import * as SequelizeStatic from 'sequelize'\nimport {Instance, Sequelize} from 'sequelize'\nimport {IPerson} from './person'\n\nexport interface UserAttributes extends IPerson {\n  username: string\n}\n\nexport interface UserInstance extends Instance<UserAttributes> {\n  dataValues: UserAttributes\n}\n\nexport type IUserModel = SequelizeStatic.Model<UserInstance, UserAttributes>\n\nexport default (sequelize: Sequelize): IUserModel => {\n  const Schema = {\n    id: {\n      allowNull:     false,\n      autoIncrement: true,\n      primaryKey:    true,\n      type:          SequelizeStatic.INTEGER,\n    },\n    username: {\n      allowNull: false,\n      unique:    true,\n      type:      SequelizeStatic.STRING,\n    },\n    createdAt: {\n      allowNull: false,\n      type:      SequelizeStatic.DATE,\n    },\n  }\n  return sequelize.define<UserInstance, UserAttributes>('User', Schema, {})\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/server/db/models/user.ts","import * as express from 'express'\nimport {jsonError, jsonSuccess} from '../../../utils/api/requests'\nimport {signup, signIn, signout, getCurrentUser} from '../api/authentication'\n\n\nexport default (app: express.Application) => {\n\n  app.post('/api/signup', (req: express.Request, res: express.Response) => {\n    signup(req.query.username, req.session)\n      .then(jsonSuccess(res))\n      .catch(jsonError(res))\n  })\n\n  app.post('/api/signin', (req: express.Request, res: express.Response) => {\n    signIn(req.query.username, req.session)\n      .then(jsonSuccess(res))\n      .catch(jsonError(res))\n  })\n\n  app.post('/api/signout', (req: express.Request, res: express.Response) => {\n    signout(req.session)\n      .then(jsonSuccess(res))\n      .catch(jsonError(res))\n  })\n\n  app.get('/api/session', (req: express.Request, res: express.Response) => {\n    getCurrentUser(req.session)\n      .then(jsonSuccess(res))\n      .catch(jsonError(res))\n  })\n\n}\n\n\n\n\n// WEBPACK FOOTER //\n// ./src/server/http/authentication.ts","import * as express from 'express'\nimport {jsonError} from '../../../utils/api/requests'\nimport {userService} from '../service/user'\nimport {postService} from '../service/post'\n\n\nconst router = express.Router()\n\nrouter.get('/', async (_: express.Request, res: express.Response) => {\n  try {\n    const posts = await postService.all()\n    res.status(200).json(posts)\n  } catch (e) {\n    jsonError(res)(e)\n  }\n})\n\nrouter.post('/create', async (req: express.Request, res: express.Response) => {\n  try {\n    const user = await userService.findByUsername(req.query.username)\n    const post = await postService.create(user, {\n      title: req.query.title,\n      body:  req.query.body,\n    })\n    res.status(200).json(post)\n  } catch (e) {\n    jsonError(res)(e)\n  }\n})\n\nrouter.get('/:id', async (req: express.Request, res: express.Response) => {\n  try {\n    const iterations = await postService.iterations(req.params.id)\n    res.status(200).json(iterations)\n  } catch (e) {\n    jsonError(res)(e)\n  }\n})\n\nrouter.post('/:id/iterate', async (req: express.Request, res: express.Response) => {\n  try {\n    const postId    = Number(req.params.id)\n    const iteration = await postService.iterate(postId, req.query)\n    res.status(200).json(iteration)\n  } catch (e) {\n    jsonError(res)(e)\n  }\n})\n\nexport default router\n\n\n\n// WEBPACK FOOTER //\n// ./src/server/http/posts.ts","import * as express from 'express'\nimport {jsonError} from '../../../utils/api/requests'\nimport {userService} from '../service/user'\nimport {UserInstance} from '../db/models/user'\n\n\nexport default (app: express.Application) => {\n\n  app.get('/api/users', (_: express.Request, res: express.Response) => {\n    userService.all()\n      .then((users: UserInstance[]) => res.status(200).json(users))\n      .catch(jsonError(res))\n  })\n\n  app.post('/api/users/create', (req: express.Request, res: express.Response) => {\n    userService.create({username: req.query.username})\n      .then((user: UserInstance) => res.status(200).json(user))\n      .catch(jsonError(res))\n  })\n\n}\n\n\n\n\n// WEBPACK FOOTER //\n// ./src/server/http/users.ts","import * as express    from 'express'\nimport * as bodyParser from 'body-parser'\n\nimport http                  from './http'\nimport { runHotMiddleware  } from './middleware'\nimport { listen            } from './listen'\nimport { monitorExceptions } from './exceptionMonitoring'\nimport { serveFrontend     } from './serveFrontend'\nimport { sequelize         } from './db'\nimport { setupSession      } from './session'\n\nconst config = require('./config.js')\nconst app    = express()\n\napp.use(bodyParser.json())\napp.use(require('helmet')())\n\nmonitorExceptions(config)(app)\nsetupSession(app) // Must happen before initializing the API\nhttp(app)\n\nif (config.env === 'development') {\n  runHotMiddleware(app)\n}\n\nserveFrontend(app)\n\nsequelize.sync().then(() => listen(app, config))\n\n\n\n// WEBPACK FOOTER //\n// ./src/server/main.tsx","import {PostInstance} from '../db/models/post'\nimport {UserInstance} from '../db/models/user'\nimport {IterationInstance} from '../db/models/iteration'\n\n\nexport class MockPostService {\n  public mockPost = {\n    postId: 9,\n    title:  'aslkdfj',\n  }\n\n  create (user: UserInstance, _iteration: {body?: string, title: string}) {\n    return new Promise<PostInstance>((resolve, _) => {\n      const mock = {dataValues: {userId: user.get('id')}}\n      resolve(<PostInstance>mock)\n    })\n  }\n\n  all () {\n    return new Promise<PostInstance[]>((resolve, _) => {\n      const mock = [\n        {dataValues: {userId: 1}},\n        {dataValues: {userId: 2}},\n        {dataValues: {userId: 2}},\n      ]\n      resolve(<PostInstance[]>mock)\n    })\n  }\n\n  iterations (postId: number) {\n    return new Promise<IterationInstance[]>((resolve, reject) => {\n      if (postId % 2) {\n        const mock = [\n          {dataValues: {postId, title: 'Post 1, with no body'}},\n          {dataValues: {postId, title: 'Post 2, with body', body: 'Body of post 2'}},\n        ]\n        resolve(<IterationInstance[]>mock)\n      } else {\n        reject({message: `Cannot find post with id ${postId}`})\n      }\n    })\n  }\n\n  iterate (postId: number, data: {body?: string, title: string}) {\n    return new Promise<IterationInstance>(async (resolve, _) => {\n      const mock = {dataValues: {...this.mockPost, ...data, postId}}\n      resolve(<IterationInstance>mock)\n    })\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/server/service/post.mock.ts","import * as Sequelize from 'sequelize'\n\nimport {models, sequelize} from '../db'\nimport {PostInstance} from '../db/models/post'\nimport {MockPostService} from './post.mock'\nimport {UserInstance} from '../db/models/user'\nimport {IterationInstance} from '../db/models/iteration'\n\n\nconst sequelizeFailure = (reject: Function) => (error: Sequelize.ValidationError) => {\n  console.warn(error) // Log full error\n  reject(error) // Return only the descriptive .errors array\n  // reject(error.errors[0]) // Return only the descriptive .errors array\n}\n\ntype IIteration = {body?: string, title: string}\n\nconst initPost = (resolve: Function, userId: number, iteration: IIteration) => (\n  async (t: Sequelize.Transaction) => {\n    const post: PostInstance = await models.Post.create({userId}, {transaction: t})\n    await models.Iteration.create({...iteration, postId: post.get('id')})\n    resolve(post)\n  }\n)\n\nexport class PostService extends MockPostService {\n  create(user: UserInstance, iteration: IIteration) {\n    return new Promise<PostInstance>((resolve: Function, reject: Function) => {\n      if (!user || !user.get('id')) {\n        return reject('Please provide a user')\n      }\n      return sequelize\n        .transaction(initPost(resolve, user.get('id'), iteration))\n        .then((post: PostInstance) => resolve(post))\n        .catch((err: Error) => reject(err))\n    })\n  }\n\n  all() {\n    return new Promise<PostInstance[]>((resolve: Function, reject: Function) => {\n      return models.Post\n        .findAll()\n        .then((posts: PostInstance[]) => resolve(posts))\n        .catch(sequelizeFailure(reject))\n    })\n  }\n\n  iterations (postId: number) {\n    return new Promise<IterationInstance[]>((resolve, reject) => {\n      return models.Iteration.findAll({where: {postId}})\n        .then(resolve)\n        .catch(reject)\n    })\n  }\n\n  iterate (postId: number, data: IIteration) {\n    return new Promise<IterationInstance>((resolve, reject) => {\n      return models.Iteration.create({postId, ...data})\n        .then(resolve)\n        .catch(reject)\n    })\n  }\n\n  comments (iterationId: number) {\n    return new Promise<IterationInstance[]>((resolve, _reject) => {\n      iterationId\n      resolve([])\n    })\n  }\n}\n\nexport const postService = new PostService\n\n\n\n// WEBPACK FOOTER //\n// ./src/server/service/post.ts","import {UserAttributes, UserInstance} from '../db/models/user'\n\nexport class MockUserService {\n  findByUsername (username: string): Promise<UserInstance> {\n    return new Promise<UserInstance>((resolve: Function, reject: Function) => {\n      if (!username) {\n        reject({message: `Please provide a username`})\n      }\n      if (username == 'thisUsernameDoesntExist') {\n        reject({message: `User with username \"${username}\" does not exist`})\n      }\n      resolve({\n        dataValues: {username, id: 123},\n        get: (key: string) => {\n          switch (key) {\n            case 'id': return 123\n            default:   throw Error(`Value for key \"${key}\" is undefined on mock user`)\n          }\n        },\n      })\n    })\n  }\n\n  create (attributes: UserAttributes): Promise<UserInstance> {\n    return new Promise<UserInstance>((resolve: Function, reject: Function) => {\n      if (attributes.username == 'thisUsernameIsntAvailable') {\n        reject({message: `Sorry, \"${attributes.username}\" is not available`})\n      }\n      resolve({dataValues: attributes})\n    })\n  }\n\n  all (): Promise<Array<UserInstance>> {\n    return new Promise<Array<UserInstance>>((resolve: Function, _: Function) => {\n      resolve([{username: 'foobar'}])\n    })\n  }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/server/service/user.mock.ts","export type StrObject = { [key: string]: string }\n\n// Adopted from:\n//   https://basarat.gitbooks.io/typescript/docs/types/literal-types.html\nexport function strEnum<T extends string>(o: Array<T>): {[K in T]: K} {\n  return o.reduce((res, key) => {\n    res[key] = key\n    return res\n  }, Object.create(null))\n}\n\n\n\n// WEBPACK FOOTER //\n// ./utils/models/index.ts","import * as Env  from '../models/Environment'\nimport { setup } from './'\n\nexport default setup(Env.Enum.development)\n\n\n\n// WEBPACK FOOTER //\n// ./webpack/frontend/development.ts","import * as webpackMerge from 'webpack-merge'\nimport * as webpack      from 'webpack'\nimport * as path         from 'path'\n\nimport * as Options from '../models/Options'\nimport * as Env     from '../models/Environment'\n\nexport const setup = (env: Env.Type) => {\n  const isProd = String(env) === String(Env.Enum.production)\n\n  const options: Options.Interface = {\n    rootDir:   path.join(__dirname, '../..'),\n    outputDir: isProd ? 'dist' : 'build',\n    devtool:   'source-map',\n    console:   !isProd,\n    isProd,\n  }\n\n  const partials = (\n    isProd\n    ? [\n      require('../loaders/typescript-loader'),\n      require('./partials/base'),\n      require('../partials/aliases'),\n    ]\n    : [\n      require('../loaders/hot-typescript-loader'),\n      require('./partials/base'),\n      require('../partials/aliases'),\n    ]\n  )\n  return webpackMerge(partials.map((m): webpack.Configuration => m.partial(options)))\n}\n\n\n\n// WEBPACK FOOTER //\n// ./webpack/frontend/index.ts","import * as webpack from 'webpack'\n\nconst { CheckerPlugin } = require('awesome-typescript-loader')\n\nexport const partial = (): webpack.Configuration => ({\n  module: {\n    rules: [\n      {\n        test:    /\\.tsx?$/,\n        loader:  require('webpack-combine-loaders')([\n          'react-hot-loader',\n          'awesome-typescript-loader',\n        ]),\n        exclude: /node_modules/,\n      }\n    ]\n  },\n\n  plugins: [ new CheckerPlugin() ],\n})\n\n\n\n// WEBPACK FOOTER //\n// ./webpack/loaders/hot-typescript-loader.ts","import * as webpack from 'webpack'\n\nconst { CheckerPlugin } = require('awesome-typescript-loader')\n\nexport const partial = (): webpack.Configuration => ({\n  module: {\n    rules: [\n      {\n        test:    /\\.tsx?$/,\n        loader:  'awesome-typescript-loader',\n        exclude: /node_modules/,\n      }\n    ]\n  },\n\n  plugins: [ new CheckerPlugin() ],\n})\n\n\n\n// WEBPACK FOOTER //\n// ./webpack/loaders/awesome-typescript-loader.ts","/**\n * NOTE: The Sequelize CLI expects config to be either .json or .js. As\n * as result, this JS file has to exist in order to execute migrations.\n * The index.ts file in this same directory is identical to this, but\n * enforces the typed IDatabaseConfig interface.\n */\n\nconst appConfig = require('../../config')\n\nmodule.exports = appConfig.db\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/server/db/config/index.js\n// module id = 39\n// module chunks = 0","module.exports = require(\"continuation-local-storage\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"continuation-local-storage\"\n// module id = 40\n// module chunks = 0","module.exports = require(\"dotenv\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"dotenv\"\n// module id = 41\n// module chunks = 0","module.exports = require(\"express-session\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"express-session\"\n// module id = 42\n// module chunks = 0","module.exports = require(\"fs\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"fs\"\n// module id = 43\n// module chunks = 0","module.exports = require(\"html-webpack-plugin\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"html-webpack-plugin\"\n// module id = 44\n// module chunks = 0","module.exports = require(\"ramda\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"ramda\"\n// module id = 45\n// module chunks = 0","module.exports = require(\"raven\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"raven\"\n// module id = 46\n// module chunks = 0","module.exports = require(\"webpack-combine-loaders\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"webpack-combine-loaders\"\n// module id = 47\n// module chunks = 0","module.exports = require(\"webpack-dev-middleware\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"webpack-dev-middleware\"\n// module id = 48\n// module chunks = 0","module.exports = require(\"webpack-hot-middleware\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"webpack-hot-middleware\"\n// module id = 49\n// module chunks = 0","module.exports = require(\"webpack-merge\");\n\n\n//////////////////\n// WEBPACK FOOTER\n// external \"webpack-merge\"\n// module id = 50\n// module chunks = 0"],"sourceRoot":""}